#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "chipvpn.h"
#include "aes.h"

void encrypt(char *data, int length) {
	char key[] = { 0x9a, 0xe8, 0x45, 0xbe, 0x41, 0xc9, 0x08, 0x80, 0xdc, 0x90, 0xbe, 0x34, 0x4e, 0x58, 0x5a, 0x1f, 
				   0xe3, 0x44, 0xa0, 0x7c, 0xfa, 0xd5, 0xc2, 0xbf, 0x68, 0xfe, 0xc4, 0xaf, 0xf2, 0xe3, 0x52, 0x22 };

	for(int i = 0; i < length; i++) {
		*(data + i) ^= *(((char*)&key) + (i % 16));
	}
}

void decrypt(char *data, int length) {
	char key[] = { 0x9a, 0xe8, 0x45, 0xbe, 0x41, 0xc9, 0x08, 0x80, 0xdc, 0x90, 0xbe, 0x34, 0x4e, 0x58, 0x5a, 0x1f, 
				   0xe3, 0x44, 0xa0, 0x7c, 0xfa, 0xd5, 0xc2, 0xbf, 0x68, 0xfe, 0xc4, 0xaf, 0xf2, 0xe3, 0x52, 0x22 };

	for(int i = 0; i < length; i++) {
		*(data + i) ^= *(((char*)&key) + (i % 16));
	}
}